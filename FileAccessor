// Created by Drew Redford
// Last updated 16/04/2015
import java.util.Scanner;
import java.io.*;

public class FileAccessor {
   
   private static String userInformation = "Users.txt";
   private static String requestFile = "Requests.txt";
   private static String signOutFile = "Books_Out.txt";
   
   
   public static void newUser(String id, String pass) throws IOException{ // Adds the new user to the users file
      File user = new File(userInformation);
      PrintWriter out;
      if (!user.exists()){
         out = new PrintWriter(user);
      }
      else {
         FileWriter fwriter = new FileWriter(user, true);
         out = new PrintWriter(fwriter);
      }
      out.println(id+"\t"+pass);
      out.close();
   }
   
   public static boolean alreadyUser(String id) throws IOException{ // Returns false if user is not in the Users file
      File user = new File(userInformation);
      Scanner inputFile = new Scanner(user);
      String compaire;
      if (!user.exists())
         return false;
      else{
         while(inputFile.hasNext()){
            compaire = inputFile.next();
            if (compaire.equals(id)){
               return true;
            }
         }
         inputFile.close();
         return false;
      }
   }
   
   public static void requestBook(String id, String bookInfo) throws IOException{ // Writes to requests.txt for book requests
      File requests = new File (requestFile);
      PrintWriter out;
      if (!requests.exists()){
         out = new PrintWriter(requests);
      }
      else {
         FileWriter fwriter = new FileWriter(requests, true);
         out = new PrintWriter(fwriter);
      }
      out.println(id);
      out.println(bookInfo);
      out.close();
   }
   public static void signOutBook(String id, String bookInfo) throws IOException{ // Writes to file to signout book
      File signOut = new File (signOutFile);
      PrintWriter out;
      if (!signOut.exists()){
         out = new PrintWriter(signOut);
      }
      else {
         FileWriter fwriter = new FileWriter(signOut, true);
         out = new PrintWriter(fwriter);
      }
      out.println(id);
      out.println(bookInfo);
      out.close();
   }
   public static boolean correctPassword(String id, String password) throws IOException{ // Used to check if id and password are correct
      File user = new File(userInformation);
      Scanner inputFile = new Scanner(user);
      String compaire;
      if (!user.exists())
         return false;
      else{
         while(inputFile.hasNext()){
            compaire = inputFile.next();
            if (compaire.equals(id)){
               compaire = inputFile.next();
               if (compaire.equals(password))
                  return true;
            }
         }
         inputFile.close();
         return false;
      }      
   }
   public static String getBooks(String id) throws IOException{ // Returns each book out on different line
      File file = new File(signOutFile);
      Scanner inputFile = new Scanner(file);
      String compaire = "";
      String books = "";
      if (!file.exists())
         return "No books signed out";
      else{
         while(inputFile.hasNextLine()){
            compaire = inputFile.nextLine();
            if (compaire.equals(id)){
               compaire = inputFile.nextLine();
               books += compaire+"\n";
            }
         }
         inputFile.close();
         if (compaire.equals(""))
            return id+" has no books signed out";
         else
            return books;
      }      

   }
   public static String getBookRequests() throws IOException{  // returns id then request per line
      File file = new File(requestFile);
      Scanner inputFile = new Scanner(file);
      String books = "";
      if (!file.exists())
         return "No books are currently requested";
      else{
         while (inputFile.hasNextLine()){
            books += inputFile.nextLine();
            books += " requested:"+inputFile.nextLine()+"\n";
         }
      }
      return books;
   }
